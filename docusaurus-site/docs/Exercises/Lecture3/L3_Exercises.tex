\documentclass[11pt]{article}
\usepackage{exercise}

\usepackage{amsmath,times,color,url}
\usepackage{amsfonts,bussproofs}

\usepackage{alltt}
\usepackage{proof}
\usepackage{tikz}
\usepackage{cancel}
\usepackage{mathtools}



\def\set#1{\{#1\}}
\def\Set#1{\{#1\}}
\def\z{{\tt 0}}
\def\o{{\tt 1}}
\def\t{{\tt 2}}
\def\a{{\tt a}}
\def\b{{\tt b}}
\def\c{{\tt c}}
\def\d{{\tt d}}
\def\DFA{{\sf DFA}}
\def\NFA{{\sf NFA}}
\def\R{{\cal R}}
\def\Picture#1{\strut\centerline{\input #1.eepic}}


\definecolor{midnightblue}{cmyk}{0.98,0.13,0,0.43}
\definecolor{olivegreen}{cmyk}{0.64,0,0.95,0.40}
\definecolor{rawsienna}{cmyk}{0,0.72,1,0.45}
\definecolor{fuchsia}{cmyk}{0.47,0.91,0,0.08}
\definecolor{shaded}{rgb}{0.7, 0.75, 0.71}

\newcommand{\Blue}[1]{{\color{blue}#1}}
\newcommand{\Red}[1]{{\color{red}#1}}
\newcommand{\Brown}[1]{{\color{brown}#1}}
\newcommand{\OliveGreen}[1]{{\color{olivegreen}#1}}
\newcommand{\RawSienna}[1]{{\color{rawsienna}#1}}
\newcommand{\MidnightBlue}[1]{{\color{midnightblue}#1}}
\newcommand{\Fuchsia}[1]{{\color{fuchsia}#1}}
\newcommand{\Gray}[1]{{\color{shaded}#1}}

\usepackage{prftree}


\newcommand{\M}[1]{{\color{midnightblue}#1}}
\newcommand{\notl}{\neg}
\newcommand{\orl}{\vee}
\newcommand{\andl}{\wedge}
\newcommand\impl{\rightarrow}

\newcommand{\setof}[1]{\{#1\}}
\newcommand{\true}{1}
\newcommand{\false}{0}

\newcommand{\Th}{\mathcal{T}}

\newcommand{\BRr}{\mathrm{B}\mathrm{R}}   
\newcommand{\Sup}{\mathrm{S}\mathrm{up}}   
\newcommand{\SUPiss}{\mathrm{S}\mathrm{up}_{\succ,\sel}}   % SUPis with selection
\newcommand{\sel}{\sigma}


% object level equality
\newcommand{\oeq}{=}%\approx}
\newcommand{\oneq}{\neq}%\not\approx}

\newcommand{\SUPis}{\mathbb{S}\mathrm{up}}   % SUP
\newcommand{\Iis}{\mathbb{I}} %inference system


\newcommand{\BRis}{\mathbb{BR}}             % binary resolution inference system
%\newcommand{\Solution}[1]{#1}
 \newcommand{\Solution}[1]{}

\newcommand{\Union}{\bigcup}


\begin{document}
\problemset{Lecture 3, October 8, 2025}

%%%% Lecture 3 - Exercises 3

\section*{\exercises{3}}

%Proof completeness, fairness, closure
\problem{3.1}
Let $\Iis$ be a sound inference system on clauses and let $S_0$ be a
non-empty set of clauses.
Consider a fair $\Iis$-inference process $S_0 \impl S_1 \impl S_2
\impl \ldots$. Let $S_{\infty}$ denote the limit of this fair
$\Iis$-inference process. Show that $S_{\infty}$ is the $\Iis$-closure
of $S_0$.


\medskip

\noindent{\bf Note:} You need to prove that $S_{\infty}$ is the
smallest $\Iis$-saturated set containing $S_0$.  Recall and use the
property  from the lecture on $\Iis$-inference processes $S_0 \impl S_1 \impl S_2
\impl \ldots$, in particular that 
every $S_i$ is a subset of the $\Iis$-closure
of $S_0$.


\medskip


\Solution{
\noindent{\bf Solution.}
\begin{enumerate}
    \item
        First, we show that $S_\infty$ is saturated.

        Towards a contradiction, assume $S_\infty$ is not saturated.
        This means there are clauses $C_1, \dots, C_n \in S_\infty$ and an inference
        \[
            \prftree{C_1}{\cdots}{C_n}{C}
        \]
        such that $C \not\in S_\infty$.

        However, since $\Iis$ is fair, $C$ is derived at some step $S_i$.
        Thus $C \in S_i \subseteq S_\infty$, a contradiction.

    % \item
    %     $I_\infty$ is contained in the $\Iis$-closure of $S_0$
    \item
        % $I_\infty$ is contained in every saturated set~$X$ with $S_0 \subseteq X$.
        Next, we show that
        if~$X$ is an $\Iis$-saturated set of clauses with $S_0 \subseteq X$,
        then $S_\infty \subseteq X$.

        By induction over $i$, we see that $S_i \subseteq X$ for all $i$:
        \begin{itemize}
            \item
                $S_0 \subseteq X$ holds by assumption.
            \item
                Assume $S_i \subseteq X$.
                Let $C$ be the clause derived in step $i+1$, i.e., $S_{i+1} \setminus S_i = \{ C \}$.
                This means that we have clauses $C_1, \dots, C_n \in S_i$ and an inference
                \[
                    \prftree{C_1}{\cdots}{C_n}{C}.
                \]
                Because of $S_i \subseteq X$, we have $C_1, \dots, C_n \in X$
                and thus, because $X$ is saturated, also $C \in X$.
                Hence $S_{i+1} \subseteq X$.
        \end{itemize}

        Recall the definition of $S_\infty \coloneqq \Union_{i \in \mathbb{N}} S_i$.
        Since $S_i \subseteq X$ for all $i$, also $S_\infty \subseteq X$.

    \item
        Since $S_\infty$ is saturated with $S_0 \subseteq S_\infty$,
        and is a subset of \emph{all} saturated sets with this property,
        $S_\infty$ is the smallest such set.
\end{enumerate}
}




\end{document}



\problem{3.2}
Consider an ordering $\succ$ on ground
non-equality atoms that is total and well-founded. We denote 
the literal ordering induced by $\succ$  also by $\succ$. 
Let $C$ and $D$ be ground clauses without equality literals. Let $A$
and $B$ respectively denote the maximal
atoms of $C$ and $D$ wrt $\succ$.

Assume that  $A$ and $B$ are syntactically the same
atoms. Assume also that $A$ occurs negatively in $C$ but only
positively in $D$. 
Show that $C\succ_{bag} D$.


\bigskip

\Solution{
\noindent
{\bf Solution:}


Since $B$ and $A$ are syntactically the same atoms, we have that $A$ is
the maximal
atom of $D$ wrt $\succ$. We know that $A$ occurs only positively in
$D$. %we conclude that $A\succ D_j$ for every literal $D_j$ of
%$D$ different than $A$. 
By using properties of the induced literal ordering
$\succ$, we conclude that $\neg A\succ A \succ \neg D_j\succ D_j$ for every atom $D_j$ of
$D$ different than $A$. Hence, by properties of the  bag extension
ordering of $\succ$, we have $\neg A\succ_{bag} D$. \\



By assumption, $A$ is the maximal atom of $C$ wrt $\succ$ and $A$
occurs only negatively in $C$. As $\neg A\succ A$, we thus conclude
that $\neg A\succ \neg C_i\succ C_i$, where $C_i$ is an atom of $C$ different than
$A$. That is $\neg A$ is the maximal literal of $C$. 


As $\neg A \succ_{bag} D$ and $\neg A$ is the maximal literal of $C$, 
 by properties of the  bag extension
ordering of $\succ$, we finally  conclude that $C\succ_{bag} D$. 



}


%ordering
\problem{3.3}
Consider strict partial orderings $\succ_i$ over $M_i$, for $i=1,
2$. Assume that $\succ_1$ and $\succ_2$ are well-founded.
We define the ordering $\succ^*$ over $M_1
\times M_2$ as:
\[(a_1,a_2) \succ^* (b_1,b_2) \Leftrightarrow \Big(a_1\succ_1 b_1
  \quad \text{or}\quad (a_1=b_1 \quad \text{and}\quad a_2\succ_2 b_2)\Big)\]


Show that $\succ^*$ is well-founded.
\Solution{
\medskip
{\bf Solution:}\\
If $\succ^*$ is not well-founded, there has to be a an infinite decreasing chain
of pairs:
\[(x_0, y_0)\succ^* (x_1, y_1) \succ^* (x_2, y_2) \succ^* \dots\]
By the definition of $\succ^*$ it follows that for each $i$, either $x_i\succ_1 x_{i+1}$
or $x_i = x_{i+1}$. However, since $\succ_1$ is well-founded, the sequence $\{x_i\}_{i\geq 0}$
has a minimal element: $x_n$ for some $n$.
Then, from the definition of $\succ^*$ we obtain $\forall i\geq n: y_n \succ_2 y_{n+1}$.
However, that is a contradiction with $\succ_2$ being well-founded.

Hence, $\succ^*$ must be well-founded as well.
}

\bigskip


%-------------------------------------------------
\problem{3.4}
Let $\succ$ be a total well-founded ordering on the ground atoms
$p_1, \ldots, p_6$ such that $p_6\succ p_5\succ p_4\succ p_3 \succ p_2
\succ p_1$. Consider
the bag extension of $\succ$; for simplicity, denote the bag extension 
of $\succ$ also by $\succ$. 

Using $\succ$, compare and order the following three clauses: 
\[p_6\vee \neg p_6,\qquad \neg p_2\vee
  p_4\vee p_5, \qquad p_2\vee p_3.\]
\Solution{
\medskip
{\bf Solution:}\\
Since $\succ$ is total, $p_i \succ p_j$ and $p_i \succ \neg p_j$ for each $1\leq j < i \leq 6$.
Therefore $p_6\succ \neg p_2$, $p_6\succ p_4$, $p_6\succ p_5$, and $p_5\succ p_2$, $p_5\succ p_3$.
Further, since for any two bags $B, B'$, such that $B\supset B'$, it holds that $B \succ B'$,
we have $p_6\vee \neg p_6 \;\succ\; p_6$ and $\neg p_2\vee p_4\vee p_5 \;\succ\; p_5$.
By combining these observations, we get:
\[p_6\vee \neg p_6 \;\succ\; p_6 \;\succ\; \neg p_2\vee p_4\vee p_5 \;\succ\; p_5 \;\succ\; p_2\vee p_3\]
Therefore by transitivity of $\succ$:
\[p_6\vee \neg p_6 \;\succ\; \neg p_2\vee p_4\vee p_5 \;\succ\; p_2\vee p_3\]
\medskip

}


\end{document}
\newpage
% ---------------------
% Lecture 2, Lab 2
\problemset{May 25-27, 2023}
\section*{\lab{2}}


\problem{2.1}
Let $\succ$ be a total well-founded ordering on the ground atoms
$p_1, \ldots, p_6$ such that $p_6\succ p_5\succ p_4\succ p_3 \succ p_2
\succ p_1$. Consider
the bag extension of $\succ$; for simplicity, denote the bag extension 
of $\succ$ also by $\succ$. 

Using $\succ$, compare and order the following three clauses: 
\[p_6\vee \neg p_6,\qquad \neg p_2\vee
  p_4\vee p_5, \qquad p_2\vee p_3.\]
\Solution{
\medskip
{\bf Solution:}\\
Since $\succ$ is total, $p_i \succ p_j$ and $p_i \succ \neg p_j$ for each $1\leq j < i \leq 6$.
Therefore $p_6\succ \neg p_2$, $p_6\succ p_4$, $p_6\succ p_5$, and $p_5\succ p_2$, $p_5\succ p_3$.
Further, since for any two bags $B, B'$, such that $B\supset B'$, it holds that $B \succ B'$,
we have $p_6\vee \neg p_6 \;\succ\; p_6$ and $\neg p_2\vee p_4\vee p_5 \;\succ\; p_5$.
By combining these observations, we get:
\[p_6\vee \neg p_6 \;\succ\; p_6 \;\succ\; \neg p_2\vee p_4\vee p_5 \;\succ\; p_5 \;\succ\; p_2\vee p_3\]
Therefore by transitivity of $\succ$:
\[p_6\vee \neg p_6 \;\succ\; \neg p_2\vee p_4\vee p_5 \;\succ\; p_2\vee p_3\]
\medskip

}


%Ordering, selection function, inference
\problem{2.2}
Let $p,q$ be boolean atoms and let $S$ be the following set of ground
formulas:
\[\{~ \neg p \lor \neg q, \quad \neg p \lor q, \quad p\lor \neg q,
  \quad p\lor q~\} \]

Take any ordering such that $p\succ  q$ and any selection function 
$\sigma$ over $S$ such that 
\[\{~\neg p \lor \underline{\neg q}, \quad \underline{\neg p} \lor q, \quad p\lor \underline{\neg q},
  \quad \underline{p}\lor q ~\}.\]


\begin{itemize}
\item[(a)] Is $\sigma$ a well-behaved selection function over $S$? Justify
  your answer!
  % yes. in the first three clauses a negative literal is selected, in the last the maximal literal is selected.
\item[(b)] How many inferences of $\BRis_{\sigma}$ are applicable to 
  $S$? Justify your answer!
  % There are no factoring inference possible, as there are no equal positve literals in any of the clauses.
  % Binary resolution can only be performed between a two selected literals with the same atom and opposite polarity. 
  % The only such literals are in the second and the last clause, hence the only possible inference is ~p \/ q, p \/ q |- q \/ q
\end{itemize}

\medskip
\Solution{
  \noindent{\bf Solution.}

\begin{itemize}
\item[(a)]
    Recall that a well-behaved selection function selects a negative literal, or all maximal literals in a clause.

    In the first three clauses, a negative literal is selected.
    In the last clause, $p$ is selected which is the (only) maximal literal due to $p \succ q$.
    Hence $\sigma$ is well-behaved.
\item[(b)]
    No factoring inference is possible, because no positive literal appears more than once in any of the clauses.
    Binary resolution can only be performed on clauses where the resolved literal is selected.
    As such, there is only one possible inference (between the second and the clause):

    \[
        \prftree{
            \underline{\neg p} \lor q
        }{
            \underline{p}\lor q
        }{
            q \lor q
        }
    \]
\end{itemize}

\medskip
}

%well-behaved/admissible orderings
\problem{2.3}
Give an example of a non-tautology ground clause with at least one selected 
literal so that this selection is not well-behaved for any ordering
$\succ$. Justify your solution! 

\medskip
\Solution{
  \noindent{\bf Solution.}

Consider the following clause: \[ p \lor \underline{p} \]
Obviously $p$ is maximal in this clause, for any ordering.
There is one maximal literal which is not selected, hence the
selection function is not well-behaved.
}

\medskip


\problem{2.4} Let $S$ be the set of clauses

\[\neg q \vee r, \quad
   \neg p \vee q, \quad
   \neg r \vee \neg q, \quad
   \neg q \vee  \neg p, \quad
   \neg p \vee \neg r, \quad
  \neg r \vee p, \quad
r \vee q \vee p\]

\begin{itemize}
\item[(a)] Prove unsatisfiabiliy of $S$ using $\BRr$.
\item[(b)] Formalize $S$ in TPTP and prove its unsatisfiability using
  {\tt Vampire}, 
  by running  {\tt Vampire} with the additional option
{\tt -av off} .
  \end{itemize}


\newpage


%%%%%%%
% Lecture 3, Lab 3
\problemset{May 25-27, 2023}
\section*{\lab{3}}

\problem{3.1}
Consider a KBO ordering $\succ$ such that 
$inverse\gg times$ by precedence. 
Consider the literal: 
\[
inverse(times(x,y) ) = times(inverse(y), inverse( x )).\] 
Compare, w.r.t $\succ$, the left- and right-hand side terms of the
equality when: 
\begin{itemize}
\item $weight(inverse)=weigth(times)=1$; 

  \Solution{
\medskip
{\bf Solution:}

As $weight(inverse)=weigth(times)=1$, 
we have: \[weight(inverse(times(x,y))) =
2+weight(x)+weight(y)\]
and 
\[weight(times(inverse(y), inverse( x ))) =
3+weight(y)+weight(x).
\]
Thus, 
\[ times(inverse(y), inverse( x )) \succ inverse(times(x,y) ).\]
\medskip
}

\item $weight(inverse) = 0$ and $weight(times) = 1$.

  \Solution{
\medskip
{\bf Solution:}

Using the given weights of $times$ and $inverse$,  we have:

\[weight(inverse(times(x,y))))=weight(times(inverse(y), inverse( x ))) =1+weight(x)+weight(y).\]

Then by precedence, given that $inverse\gg times$, we conclude that:
 
 \[
inverse(times(x,y) ) \succ times(inverse(y), inverse( x )).
\]
}
\end{itemize}




\problem{3.2}
Let $\Sigma$ be a signature containing only function symbols such that
$\Sigma$ contains at least one constant.
Let $\gg$ be a  precedence relation on $\Sigma$ and
$w:\Sigma\to\mathbb{N}$ be a weight function compatible with $\gg$.
Consider the (ground) Knuth-Bendix order $\succ$ induced by $\gg$
and $w$ on the set of ground
terms of $\Sigma$. Describe the set of ground terms that have the minimal
weight wrt $\succ$.


\bigskip
\Solution{
\noindent
{\bf Solution:}


Every ground term of $\Sigma$ that has the minimal
weight wrt $\succ_{KB}$ is either: 

-- a constant $c\in \Sigma$ such that $c$ has the minimal weight
among the constants of $\Sigma$, 

-- or a term $f^n(c)$, with $n\neq 0$, where $c\in\Sigma$ is a constant of the
minimal weight among the constants of $\Sigma$ and $w(f)=0$.


}


% ground superposition
\problem{3.3} 
Consider the set $S$ of ground formulas:
%
\begin{align*}
%
% ['or', ['=', ['g', ['f', 'a']], 'a'], ['=', ['g', ['f', 'b']], 'a']]
  \{~ & g(f(a)) = a \lor g(f(b)) = a,
~\\~
% ['=', ['f', 'a'], 'a']
& f(a) = a,
~\\~
% ['or', ['not', ['=', ['f', 'b'], ['f', 'b']]], ['=', ['f', 'b'], 'a']]
& f(b)  \neq  f(b) \lor f(b) = a,
~\\~
% ['not', ['=', ['g', 'a'], 'a']]
  & g(a)  \neq  a ~\}
%
\end{align*}
%
\noindent Show that $S$ is unsatisfiable by applying saturation on $S$ using an
inference process based on the ground superposition
calculus $\SUPis_{\succ,\sigma}$ (including the inference rules of binary
resolution $\BRis_\sigma$), where $\sigma$ is a well-behaved selection
function wrt $\succ$ and: 
\begin{itemize}
  \item[(a)] the ordering $\succ$ is the KBO ordering generated by the precedence 
    $f\gg a \gg g \gg b$ and the weight function $w$ with $w(f)=0,
    w(b) = 1, w(a) = 2, w(g) = 3$; 
   % Further, $\sigma$ is a well-behaved selection function wrt $\succ$.

  \item[(b)] the ordering $\succ$ is the KBO ordering generated by the precedence
    $g\gg a \gg b \gg f$ and the weight function $w$ with $w(g)=0, w(b) = 1, w(f) = 1, w(a) = 3$.
  %  Further, $\sigma$ is a well-behaved selection function wrt $\succ$.
\end{itemize}
Give details on what literals  are selected and which terms are maximal.

\Solution{
\medskip

{\bf Solution:}\\
For clarity, we first number the clauses:
\begin{align*}
  (1)~ & g(f(a)) = a \lor g(f(b)) = a \\
  (2)~ & f(a) = a \\
  (3)~ & f(b)  \neq  f(b) \lor f(b) = a \\
  (4)~ & g(a)  \neq  a
\end{align*}
In the solution we mark selected literals by underlining them.
\begin{itemize}
  \item[(a)]    
    The following literals are selected:
\begin{align*}
  (1)~ & \underline{g(f(a)) = a} \lor g(f(b)) = a & ~~\text{($\{g(f(a)), a\} \succ \{g(f(b)), a\}$ since $g(f(a))\succ g(f(b))$ by weight)} \\
  (2)~ & \underline{f(a) = a} & \text{(since it is the only literal in the clause)}\\
  (3)~ & \underline{f(b)  \neq  f(b)} \lor f(b) = a & \text{(since $f(b)  \neq  f(b)$ is negative)}\\
  (4)~ & \underline{g(a)  \neq  a} & \text{(since it is the only literal in the clause)}
\end{align*}
    By equality resolution over (3), we get:
    \[(5)~\underline{f(b) = a}\]
    Next, since $f(a)\succ a$ (by precedence) and $g(f(a))\succ a$ (by weight), we apply superposition over
    (2) and (1), and get
    \[(6)~ \underline{g(a) = a} \lor g(f(b)) = a,\]
    where $g(a)=a$ is selected since $g(a)\succ g(f(b))$ (by weight) and thus $\{g(a), a\}\succ \{g(f(b)), a\}$.\\
    We then apply binary resolution over (6) and (4):
    \[(7)~ \underline{g(f(b)) = a}\]
    Next, since $a\succ f(b)$ (by weight) and $g(a)\succ a$ (by weight), we apply superposition over (4) and (5):
    \[(8)~\underline{g(f(b)) \neq a}\]
    Finally, we apply binary resolution over (7) and (8):
    \[(9)~\square\]
    Hence, $S$ is unsatisfiable.

  \item[(b)] All steps of the solution (a) depended on the following comparisons between
    (bags of) terms: $\{g(f(a)), a\} \succ \{g(f(b)), a\},\; f(a)\succ a,\; g(f(a))\succ a,\;
    \{g(a), a\}\succ \{g(f(b)), a\},\; a\succ f(b),\; g(a)\succ a$.
    However, all these comparisons hold also for the KBO generated by the precedence and the weight
    function from (b):
    \begin{itemize}
      \item from $g(f(a))\succ g(f(b))$ by weight we get $\{g(f(a)), a\} \succ \{g(f(b)), a\}$,
      \item $f(a)\succ a$ by weight,
      \item $g(f(a))\succ a$ by weight,
      \item from $g(a)\succ g(f(b))$ by weight it follows $\{g(a), a\}\succ \{g(f(b)), a\}$,
      \item $a\succ f(b)$ by weight,
      \item $g(a)\succ a$ by precedence.
    \end{itemize}
    Therefore the proof in (b) is the same as in (a).
\end{itemize}

\medskip
}



\newpage


%%%%%%%%%%%%
% Lecture 4 , Lab 4
\problemset{May 25-27, 2023}
\section*{\lab{4}}

\problem{4.1}
Apply the unification algorithm and show the most general unifier of
the following atoms: 

\begin{description}
\item[(a)] $p(a, f(y), y)$ and $p(a,x,f(x))$;

  \Solution{
\noindent
{\bf Solution:}

\[
\begin{array}{ll}
E=\{p(a, f(y), y) = p(a,x,f(x))\} & \implies\\
E= \{ a=a, \quad f(y)=x, \quad y=f(x) \}  & \implies\\
E= \{f(y)=x, \quad y=f(x)\}& \implies\\
E= \{ x=f(y), \quad y=f(x) \}  & \implies_{x\to f(y)}\\
E= \{\Gray{x=f(y)}, \quad y=f(f(y))\} &\implies_{Failure}

\end{array}
\]
\bigskip
}

\item[(b)] $p(f(x,a), f(f(b,a)))$ and $p(z,f(z))$;

  \Solution{
\noindent
{\bf Solution:}
Note that $f$ occurs both as a unary and as a binary function. 
Hence, there are two possibilities to proceed: 
\begin{itemize}
\item Report syntax error because one cannot use the same function
  name with different arities;
\item Consider the unary and binary occurences of $f$ as different
  functions. Use then  $f_1$ for the unary occurence of $f$ and $f_2$
  for the binary function $f$. (Note: In Prolog, it is still possible 
to use the same function name with different arities.). 

In this case, we have: 
\[\begin{array}{ll}
E=\{p(f_2(x,a), f_1(f_2(b,a))) =p(z,f_1(z))\}& \implies\\
E=\{f_2(x,a)=z,\quad f_1(f_2(b,a))=f_1(z)\} & \implies\\
E=\{z=f_2(x,a),\quad f_1(f_2(b,a))=f_1(z)\} & \implies_{z\to
  f_2(x,a)}\\
E=\{\Gray{z=f_2(x,a)},\quad f_1(f_2(b,a))=f_1(f_2(x,a))\} &\implies\\
E=\{\Gray{z=f_2(x,a)},\quad f_2(b,a)=f_2(x,a)\} & \implies\\
E=\{\Gray{z=f_2(x,a)},\quad b=x, \quad a=a\} & \implies\\
E=\{\Gray{z=f_2(x,a)},\quad x=b, \quad a=a\} & \implies_{x\to b}\\
E=\{\Gray{z=f_2(b,a)},\quad \Gray{x=b}, \quad a=a\} & \implies\\
E=\{\Gray{z=f_2(b,a)},\quad \Gray{x=b}\} & \implies_{Success}
\end{array}
\]
The mgu in this case is $\{z\to f_2(b,a), x\to b\}$.
\end{itemize}\bigskip
}

\item[(c)] $p(f(x,y),f(y,z))$ and $p(z,f(w,f(y,w)))$.

  \Solution{
\noindent
{\bf Solution:}

\[\begin{array}{ll}

E=\{p(f(x,y),f(y,z)) \ = \ p(z,f(w,f(y,w)))\}& \implies\\
E= \{ f(x,y) =z,\quad f(y,z)= f(w,f(y,w)) \}& \implies\\
E= \{ \Gray{z=f(x,y)},\quad f(y,z)=f(w,f(y,w))\} & \implies_{ z\to f(x,y)  }\\
E= \{ \Gray{z=f(x,y)}, \quad f(y,f(x,y)=f(w,f(y,w))\}  \} & \implies\\
E= \{ \Gray{z=f(x,y)}, \quad y=w, \quad f(x,y)=f(y,w)\}&\implies_{y\to w
  }\\
E= \{ \Gray{z=f(x,w)}, \quad \Gray{y=w}, \quad f(x,w), f(w,w)\} \} &
\implies\\
E= \{ \Gray{z=f(x,w)}, \quad \Gray{y=w}, \quad x=w, \quad w=w\} &
\implies_{x\to w}\\
E= \{ \Gray{z=f(w,w)}, \quad \Gray{y=w}, \quad \Gray{x=w},\quad w=w\}&
\implies \\
E= \{ \Gray{z=f(w,w)}, \quad \Gray{y=w}, \quad \Gray{x=w}\}\implies_{Success}
\end{array}
\]


The mgu is: \[
{\{z\to f(w,w),\ y\to w, x\to w
  \} }.
\]
}
\bigskip
\end{description}

Note: $x,y,z,w$ denote variables, $f$ is a function symbol, $p$ is a 
predicate symbol and $a,b$ are constants. 
\medskip




\problem{4.2}
Consider the following set $S$ of clauses:
\[
\begin{array}{l}
\neg p(z,a) \orl \neg p(z,x) \orl \neg p(x,z)\\
p(y,a) \orl p(y,f(y))\\
p(w,a) \orl p(f(w),w)
\end{array}
\]
where $p$ is a predicate symbol, $f$ is a function symbol, $x,y,z,w$ are variables and $a$ is a
constant. 

\noindent Give a refutation proof of $S$ by using the non-ground binary resolution
inference system $\BRis$. For each newly derived clause, 
label the clauses from which it was derived by which inference
rule  and indicate
most general unifiers.

\Solution{
  \bigskip

\noindent
{\bf Solution:}

For simplicity, we name the given clauses by numbers: 
\[
\begin{array}{ll}
(1) & \neg p(z,a) \orl \neg p(z,x) \orl \neg p(x,z)\\
(2) & p(y,a) \orl p(y,f(y))\\
(3)& p(w,a) \orl p(f(w),w)
\end{array}
\]


By negative factoring on (1), with the mgu $\{x\to a\}$, we get: 
\[(4) \quad \neg p(z,a) \orl \neg p(a,z)\]

By negative factoring on (4), with the mgu $\{z\to a\}$, we get: 
\[(5) \quad \neg p(a,a)\]

By resolution on (5) and (2), with the mgu $\{y\to a\}$, we get:
\[(6) \quad  p(a,f(a))\]

By resolution on (4) and (6), with the mgu $\{z\to f(a)\}$, we get:
\[(7) \quad \neg p(f(a), a)\]

By resolution on (3) and (7), with the mgu $\{w\to a\}$, we get:
\[(8) \quad  p(a, a)\]

By resolution on (5) and (8), we finally obtain the empty clause:
\[(9) \quad  \Box\]

Hence, our input set $S$ of clauses (1), (2) and (3) is
unsatisfiable.
}

\bigskip





\problem{4.3}
Let $p$ denote  a unary predicate symbol, $f$  a unary function
symbol, $x,y$ variables and $c$ a constant.
Let $C_1$ be the clause $p(x) \vee p(y)$ and consider $C_2$ to be the
clause $p(x)$. Further, let $D$ denote the clause $p(f(c))$. % We
%consider $\succ$ to be an ordering over literals; for simplicity, we
%write $\succ$ also  for the bag extension of $\succ$ for comparing
%clauses. 


\begin{itemize}
\item[(a)] Does $C_1$ subsume $D$?
\item[(b)] Does $C_2$ subsume $D$?
\end{itemize}

Justify your answers!
\medskip

\Solution{
{\bf Solution:}
\begin{itemize}
  \item[(a)] No. For $C_1$ to subsume $D$, there must be a substitution $\theta$ such
    that $C_1\theta$ is a sub-multiset of $D$. However, since $C_1$ has two literals, also $C_1\theta$
    has two literals and therefore it cannot be a sub-multiset of $D$, which only has one literal.
  %  (Note that for a substitution $\theta = \{x\mapsto f(c), y\mapsto f(c)\}$, it holds that $C\theta\succ D$.
   % Therefore, while $C\theta$ is a \emph{subset} of $D$, it is not a \emph{sub-multiset}.) 
  \item[(b)] Yes. For $\theta = \{x\mapsto f(c)\}$, it holds that $C_2\theta$ is a sub-multiset of $D$.
\end{itemize}

}



%non-ground sup
\problem{4.4}
Let $x$ denote a variable, $a,b,c$ constants, and $f$  a
 unary function symbol. \\
Give a superposition refutation of the following set of two clauses:

\[
  \begin{array}{lll}
    \{~ &x \oeq f(c),&\\
    &a\oneq b &~\}
   \end{array}
 \]
 such that, in every inference, the premises and
 the conclusion of that inference do not use the symbols $f,c$
 together with the symbols $a,b$. That is, 
 every inference has the following property: if the premise or the
 conclusion contain any of the symbols $f,c$,
 then the premise and the conclusion contain neither $a$ nor $b$.
 
In your proof, use only the inference system of the superposition
calculus $\SUPis$ (without ordering and selection function); that is,
no inferences of binary resolution $\BRis$ should be used.
For each newly derived clause,
clearly label the clauses from which it was derived and indicate most general unifiers.

\medskip

\Solution
{\noindent{\bf Solution.}
Note that if we apply a rule to two clauses, we consider the variables in both clauses to be distinct, even if the two clauses are actually the same one. 
Therefore we when we apply can use superposition using $f(c) = x$, as both of the premises it is the same thing as applying it to the premises $f(c) = x$ and $f(c) = y$.
This means we can do the following derivation:

\medskip

$
  \begin{array}{lcll}
    1) & f(c) = x & \text{Axiom}\\
    2) & a \neq b & \text{Axiom}\\
    3) & x = y & \text{Superposition using (1), and (1), $\sigma = \emptyset$}\\
    4) & a \neq x & \text{Superposition using (2), and (3), $\sigma = \Set{ y \mapsto b }$}\\
    5) & \Box & \text{Equality resolution using (4), $\sigma = \Set{ x \mapsto a }$}\\
  \end{array}
$
}
\medskip



\problem{4.5}

Let $f$ be a unary and $g$ be a binary function symbol.
Further let $a, b, c$ be constants, and $x, y, z$ be variables.
We define the weight function $w(s) = w(v) = 1$, for every symbol $s$
and variable $v$, and let $g \gg f \gg c \gg b \gg a$.
Answer the following questions using a KBO with the weight
function $w$ and the precedence relation $\gg$ to order terms,
and its extension to compare literals and clauses. 

\begin{itemize}
  \item[(a)] Do the clauses $C_1$ and $C_2$ make the clause $C_3$ redundant?
    \begin{align*}
      C_1:~ &~ a \oneq b \lor f(a) \oneq a \\
      C_2: ~ &~ f(f(x)) \oeq a \\
      C_3: ~ &~ f(f(b)) \oneq b \lor f(a) \oneq a
    \end{align*}
    % Answer: no, because f(f(x)) = a is incomparable to f(f(b)) != b \/ f(a) != a
    %         shouldn't the answer be "yes"? because we can use demodulation(C_2, C_3) to derive C_1.
  \item[(b)] Does the clause $ C_4 $ make the clause $ C_5 $ redundant?
    \begin{align*}
      C_4: ~ &~ f(g(x, a)) \oneq f(y) \\
      C_5: ~ &~ f(g(x, z)) \oneq f(g(y, b)) \lor f(g(x, b)) \oneq f(g(a, b))
    \end{align*}
    % Answer: yes because f(g(x,a)) != f(y) is unsat, and smaller than the latter clause
  \item[(c)] Does the clause $ C_6 $ make the clause $ C_7 $ redundant?
    \begin{align*}
      C_6: ~ &~ g(x, y) \oneq f(x) \\
      C_7: ~ &~ g(f(x), f(z)) \oneq f(f(x)) \lor g(a, b) \oneq c
    \end{align*}
    % Answer: yes because f(g(x,a)) != f(y) < g(x, f(z)) != f(f(x)) < g(x, f(z)) != f(f(x)) \/ g(a,b) != c
\end{itemize}


\medskip

\Solution{
  \noindent{\bf Solution.}


\begin{itemize}
  \item[(a)] No, because $C_2 : f(f(x)) = a$ is incomparable to $C_3 : f(f(b)) \neq b \lor f(a) \neq a $.
    % Answer: no, because f(f(x)) = a is incomparable to f(f(b)) != b \/ f(a) != a
    %         shouldn't the answer be "yes"? because we can use demodulation(C_2, C_3) to derive C_1.
  \item[(b)] Yes, because $C_4 : f(g(x, a)) \neq f(y)$ is unsat, and smaller than $C_5$.
  \item[(c)] Yes because firstly we can rename the variable $z$ to $y$ in the second clause.  
    This means, since $g(x, y) \oneq f(x) \prec g(f(x), f(z)) \oneq f(f(x))$, that $C_6 \prec C_7$.
    Further $g(f(x), f(z)) \oneq f(f(x))$ is an instance of $g(x, y) \oneq f(x)$, which means that we $C_6$ implies $C_7$.
    % Answer: yes because f(g(x,a)) != f(y) < g(x, f(z)) != f(f(x)) < g(x, f(z)) != f(f(x)) \/ g(a,b) != c $
  \end{itemize}
  }




%redundancy, subsumption demodulation 
\problem{4.6}
Consider the following inference:
%Aduct21S#27
\[\prftree{
  x \oeq f(c)\lor p(x)
}{
  f(h(b)) \oeq h(g(y,y)) \lor h(g(d,b))\oneq f(c)
}{
  p ( h ( g ( d , b ) ) ) \lor f ( h ( b) )  \oeq  h(g(y,y))
}\]
in the non-ground
superposition inference system $\SUPis$ ({\bf without} the rules of the non-ground
binary resolution inference system $\BRis$),
where $p$ is a predicate symbol, $f$, $g$, $h$ are function symbols,
$b, c, d$ are constants, and $x$, $y$ are variables.
%
\begin{itemize}
    \item[(a)]
        Prove that the above inference is a sound inference of $\SUPis$.
        % suppose M |=  x = f(c) \/ p(x)                             (1)
        %         M |=  f(h(b)) = h(g(y,y)) \/ h(g(d,b)) != f(c)     (2)
        % If M |= f(h(b)) = h(g(y,y)), then the conclusion is obviously true in M.
        % othersise due to (2) it must be the case that M |= h(g(d,b)) != f(c), which means due to (1) that M |= p(g(d,b)) must hold, which means that the conclusion is true in M as well.
    \item[(b)]
        Is the above inference a simplifying inference of $\SUPis$?
        Justify your answer. 

        % Countermodel for Hyp1, Concl |= Hyp2
        % M |= p(x)
        % M(f)(C) = H
        % M(f)(..) = F
        % M(h(...)) = H
        % M(g(...)) = G
        % M(c) = C
        % M(d) = D
        % M(b) = B

        % Countermodel for Hyp2, Concl |= Hyp1
        % M |= ~p(x)
        % domain = {A, B}
        % M(f)(..) = A
        % M(h)(..) = A

\end{itemize}

%
\medskip

\Solution{
  \noindent{\bf Solution.} 
\begin{itemize}
    \item[(a)]
        Let $M$ be a model of both assumptions of the rule: 
        % suppose M |=  x = f(c) \/ p(x)                             (1)
        %         M |=  f(h(b)) = h(g(y,y)) \/ h(g(d,b)) != f(c)     (2)
        \begin{align*}
          M &\models x = f(c) \lor p(x) & \text{(1)} \\
          M &\models f(h(b)) = h(g(y,y)) \lor h(g(d,b)) \neq f(c) & \text{(2)}\\
        \end{align*}
        % If M |= f(h(b)) = h(g(y,y)), then the conclusion is obviously true in M.
        If $M \models f(h(b)) = h(g(y,y))$, then the conclusion is obviously true in $M$.
        % othersise due to (2) it must be the case that M |= h(g(d,b)) != f(c), which means due to (1) that M |= p(g(d,b)) must hold, which means that the conclusion is true in M as well.
        Otherwise due to (2) we know that it must be the case that $M \models h(g(d,b)) \neq f(c)$. 
        This means due to (1) that $M \models p(g(d,b))$ must hold, which means that the conclusion is true in this case as well.
    \item[(b)]
        We will call the left assumption $C_1$ and the right assumption of the rule $C_2$, and the conclusion of the rule $D$.

        In order for the rule to be a simplifying rule, it could either make $C_1$, or $C_2$ redundant, so there are two cases to check.

        Let's first have a look at whether $C_1$ is being made redundant. 
        In order for that to hold we would need to have that $C_2, D \models C_1$. 
        This does not hold since the model $M_1$ is a counterexample.

        % Countermodel for Hyp2, Concl |= Hyp1
        % M |= ~p(x)
        % domain = {A, B}
        % M(f)(..) = A
        % M(h)(..) = A
        \newcommand\A{\mathsf a}
        \newcommand\B{\mathsf b}
        \newcommand\C{\mathsf c}
        \newcommand\D{\mathsf d}
        \begin{align*}
          M_1(\top) &= \Set{\A, \B}\\
          M_1(p) &= \emptyset\\
          M_1(f)(x) &= \A\\
          M_1(h)(x) &= \A\\
          M_1(g)(x,y) &= \A\\
        \end{align*}
        (Note that by $M(\top)$ we denote the domain of the model here.)

        Similarly we can build a counterexample $M_2$ for the statement $C_1, D \models C_2$.

        % Countermodel for Hyp1, Concl |= Hyp2
        % M |= p(x)
        % M(f)(C) = H
        % M(f)(..) = F
        % M(h(...)) = H
        % M(g(...)) = G
        % M(c) = C
        % M(d) = D
        % M(b) = B
        \newcommand\F{\mathsf f}
        \newcommand\G{\mathsf g}
        \renewcommand\H{\mathsf h}
        \begin{align*}
          M_2(p) = M_2(\top) &= \Set{\B, \C, \D, \F, \G, \H}\\
          M_2(b) &= \B\\
          M_2(c) &= \C\\
          M_2(d) &= \D\\
          M_2(f)(x) &= \begin{cases}
            \H & \text{if $x = \C$}\\
            \F & \text{else}
          \end{cases}\\
          M_2(g)(x, y) &= \G\\
          M_2(h)(x) &= \H\\
        \end{align*}


\end{itemize}


}





\problem{4.7}  Recall that the inverse of the binary relation $r_1(x,y)$ is the binary
relation  $r_2(y,x)$ such that $r_1(x,y)$ if and only if
$r_2(y,x)$. \medskip

Prove that the inverse of a dense order is also dense. For doing so,
you are required to do the following steps: 

\begin{itemize}
\item Formalize the problem in {\tt TPTP} and prove it
using {\tt Vampire}. % Provide your TPTP encoding and {\tt Vampire}


\item Explain the superposition reasoning part of the {\tt Vampire} proof by
  detailing the superposition inferences, generated clauses and mgus
  in the
poof. Use  {\tt Vampire}  with the AVATAR option off,
  that is {\tt -av off}. 
\end{itemize}


%VAMPIRE
\problem{4.8}
Consider the group theory axiomatization used in the lecture. Prove
that the group's left identity element $e$ is also a right
identity. 


\begin{itemize}
\item Formalize the problem in {\tt TPTP} and use it
using {\tt Vampire}, by running  {\tt Vampire} with the additional option
{\tt -av off} .


\item Explain the superposition reasoning part of the {\tt Vampire} proof by
  detailing the superposition inferences, generated clauses and mgus
in the
poof. 
\end{itemize}

\end{document}
